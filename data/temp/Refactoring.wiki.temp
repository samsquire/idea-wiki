++ Refactoring

* refactoring doesn't change external appearance (compatibility)